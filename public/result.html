<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>íˆ¬í‘œ ê²°ê³¼ - ì§œì¥ë©´ vs ì§¬ë½•</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <header>
      <h1 class="title">ğŸ“Š íˆ¬í‘œ ê²°ê³¼</h1>
      <p class="subtitle">ì‹¤ì‹œê°„ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ëŠ” íˆ¬í‘œ í˜„í™©</p>
    </header>

    <main class="result-section">
      <div id="loading" class="loading">
        <div class="spinner"></div>
        <p>ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
      </div>

      <div id="results" class="results hidden">
        <div class="result-card jajangmyeon-result">
          <div class="result-emoji">ğŸœ</div>
          <h2>ì§œì¥ë©´</h2>
          <div class="vote-count" id="jajangmyeonCount">0í‘œ</div>
          <div class="progress-bar">
            <div class="progress-fill jajangmyeon-bar" id="jajangmyeonBar"></div>
          </div>
          <div class="percentage" id="jajangmyeonPercent">0%</div>
        </div>

        <div class="result-card jjamppong-result">
          <div class="result-emoji">ğŸ²</div>
          <h2>ì§¬ë½•</h2>
          <div class="vote-count" id="jjamppongCount">0í‘œ</div>
          <div class="progress-bar">
            <div class="progress-fill jjamppong-bar" id="jjamppongBar"></div>
          </div>
          <div class="percentage" id="jjamppongPercent">0%</div>
        </div>

        <div class="total-votes">
          <p>ì´ <span id="totalVotes">0</span>ëª…ì´ íˆ¬í‘œí–ˆìŠµë‹ˆë‹¤</p>
        </div>
      </div>

      <div class="links">
        <a href="/vote" class="link primary">ë‹¤ì‹œ íˆ¬í‘œí•˜ê¸° â†’</a>
        <button onclick="loadResults()" class="link refresh">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
      </div>
    </main>
  </div>

  <script>
    // ê²°ê³¼ ë¡œë“œ í•¨ìˆ˜
    async function loadResults() {
      const loadingElement = document.getElementById('loading');
      const resultsElement = document.getElementById('results');
      
      try {
        loadingElement.classList.remove('hidden');
        resultsElement.classList.add('hidden');
        
        const response = await fetch('/api/results');
        const data = await response.json();
        
        if (data.success) {
          const { results } = data;
          
          // ì§œì¥ë©´ ê²°ê³¼
          document.getElementById('jajangmyeonCount').textContent = `${results.jajangmyeon}í‘œ`;
          document.getElementById('jajangmyeonPercent').textContent = `${results.percentages.jajangmyeon}%`;
          document.getElementById('jajangmyeonBar').style.width = `${results.percentages.jajangmyeon}%`;
          
          // ì§¬ë½• ê²°ê³¼
          document.getElementById('jjamppongCount').textContent = `${results.jjamppong}í‘œ`;
          document.getElementById('jjamppongPercent').textContent = `${results.percentages.jjamppong}%`;
          document.getElementById('jjamppongBar').style.width = `${results.percentages.jjamppong}%`;
          
          // ì´ íˆ¬í‘œ ìˆ˜
          document.getElementById('totalVotes').textContent = results.total;
          
          // ê²°ê³¼ í‘œì‹œ
          loadingElement.classList.add('hidden');
          resultsElement.classList.remove('hidden');
        }
      } catch (error) {
        console.error('ê²°ê³¼ ë¡œë“œ ì˜¤ë¥˜:', error);
        loadingElement.innerHTML = '<p class="error">ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.</p>';
      }
    }
    
    // í˜ì´ì§€ ë¡œë“œ ì‹œ ê²°ê³¼ í‘œì‹œ
    window.addEventListener('DOMContentLoaded', loadResults);
  </script>
</body>
</html>
